<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: "en" }}">

  {%- include head.html -%}

  <body>

    <script type="text/javascript">
      // ページが読み込まれる前にパスワードチェックを実行
      (function() {
        // localStorageに保存する際のキー（名前）
        const storageKey = 'passwordVerified';

        // 1. 既に認証済みかチェック
        if (localStorage.getItem(storageKey) === 'true') {
          // 認証済みの印があれば、何もしないで処理を終了
          return;
        }

        // --- ここから下は、認証されていない場合のみ実行 ---

        // 2. パスワードの入力を求める
        const correctPassword = "tetsujin";
        let inputPassword = prompt("パスワードを入力してください:", "");

        // 3. パスワードが正しいかチェック
        if (inputPassword === correctPassword) {
          // 正しければ、ブラウザに「認証済み」の印を保存する
          localStorage.setItem(storageKey, 'true');
        } else {
          // 間違っていれば、ページをブロックする（以前と同じ）
          document.documentElement.innerHTML = `
            <head>
              <title>アクセスが拒否されました</title>
              <meta charset="utf-8">
              <style>
                body { font-family: sans-serif; text-align: center; padding: 50px; }
              </style>
            </head>
            <body>
              <h1>パスワードが違います。</h1>
            </body>
          `;
          throw new Error("Incorrect password.");
        }
      })();
    </script>

    {%- include header.html -%}

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        {{ content }}
      </div>
    </main>

    {%- include footer.html -%}

  </body>

</html>
